*&---------------------------------------------------------------------*
*& Include          ZLCL_CLASS
*&---------------------------------------------------------------------*

*Classes para botÃµes na ALV
*-----------------------------------
* class lcl_handle_events
*

*Cenas do ALV
data:
      lo_sec_alv TYPE REF TO cl_salv_table.

DATA: lt_selected_rows TYPE salv_t_row,
      ls_selected_row  LIKE LINE OF lt_selected_rows.

TYPES: BEGIN OF ty_line,
         checkbox TYPE c LENGTH 1,
         ebeln    TYPE ekko-ebeln,
         ebelp    TYPE ekpo-ebelp,
         aedat    TYPE ekko-aedat,
         matnr    TYPE ekpo-matnr,
         maktx    TYPE makt-maktx,
         menge    TYPE ekpo-menge,
         meins    TYPE ekpo-meins,
         netpr    TYPE ekpo-netpr,
         werks    TYPE ekpo-werks,
         lgort    TYPE ekpo-lgort,
         ekorg    TYPE ekko-ekorg,
         ekgrp    TYPE ekko-ekgrp,
         bukrs    TYPE ekko-bukrs,
       END OF ty_line.

       DATA: lo_alv     TYPE REF TO cl_salv_table.

DATA: lt_temp_data TYPE TABLE OF ty_line,
      ls_temp_data TYPE ty_line.

DATA: gr_events     TYPE REF TO cl_salv_events_table.

"Ordens de compras e items
DATA: gt_data TYPE TABLE OF ty_line,
      ls_data TYPE ty_line.

CLASS lcl_handle_events DEFINITION.
  PUBLIC SECTION.
    TYPES: BEGIN OF ty_line,
             ebeln TYPE ekko-ebeln,
             ebelp TYPE ekpo-ebelp,
             aedat TYPE ekko-aedat,
             matnr TYPE ekpo-matnr,
             maktx TYPE makt-maktx,
             menge TYPE ekpo-menge,
             meins TYPE ekpo-meins,
             netpr TYPE ekpo-netpr,
             werks TYPE ekpo-werks,
             lgort TYPE ekpo-lgort,
             ekorg TYPE ekko-ekorg,
             ekgrp TYPE ekko-ekgrp,
             bukrs TYPE ekko-bukrs,
           END OF ty_line.

    METHODS: on_click FOR EVENT added_function OF cl_salv_events.

  PRIVATE SECTION.
    DATA: gr_alv TYPE REF TO cl_salv_table.
ENDCLASS.

CLASS lcl_handle_events  IMPLEMENTATION.
  METHOD on_click.
    CASE sy-ucomm.  "at user command
      WHEN 'LIBERAR'.

        PERFORM get_selected_rows.
        PERFORM release_order.

        REFRESH lt_temp_data.
        PERFORM get_data.

        lo_alv->refresh(
          EXPORTING
            refresh_mode = if_salv_c_refresh=>soft " ALV: Data Element for Constants
        ).

      WHEN OTHERS.
    ENDCASE.
  ENDMETHOD.                    "on_click
ENDCLASS.

DATA: event_handler TYPE REF TO lcl_handle_events.                  "lcl_handle_events IMPLEMENTATION
